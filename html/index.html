<html>
    <head>

    </head>
    <body>
        <canvas id="graph" width="800" height="400" style="background-color: darkgrey"></canvas>
        <script>
                const MAX_POINTS = 60;
    
                let canvas = document.getElementById('graph');
                let ctx = canvas.getContext('2d');
                let points = [];

                let counter = 0;

                setInterval(() => {
                    drawTemp();
                }, 60000);

                drawTemp();

                function drawTemp() {
                    var xhttp = new XMLHttpRequest();
                    xhttp.open("GET", "/getTemp", false);
                    xhttp.send();
                    addPoint(parseFloat(xhttp.responseText));
                }
    
                function addPoint(temp) {
                    if (points.length <= MAX_POINTS) {
                        points.push(temp);
                    }
                    else {
                        for (let i = 0; i <= MAX_POINTS - 1; i++) {
                            points[i] = points[i + 1];
                        }
                        points[MAX_POINTS] = temp;
                    }
    
                    ctx.clearRect(0, 0, canvas.width, canvas.height);

                    ctx.strokeStyle = "black";
                    ctx.font = "20px Courrier New";
                    ctx.textAlign="right";
                    for (let i = 1; i < MAX_POINTS; i++) {
                        ctx.beginPath();
                        ctx.moveTo(i * (canvas.width / MAX_POINTS), 0);
                        ctx.lineTo(i * (canvas.width / MAX_POINTS), canvas.height);
                        ctx.stroke();
                    }

                    for (let i = 1; i < 10; i++) {
                        ctx.fillText((10 - i) * 4 , canvas.width - 1, i * (canvas.height / 10) - 1);
                        ctx.beginPath();
                        ctx.moveTo(0, i * (canvas.height / 10));
                        ctx.lineTo(canvas.width, i * (canvas.height / 10));
                        ctx.stroke();
                    }

                    ctx.strokeStyle = "blue";
                    for (let i = 0; i < points.length && points.length > 1; i++) {
                        ctx.beginPath();
                        ctx.moveTo(i * (canvas.width / MAX_POINTS), canvas.height - (points[i] * 10));
                        ctx.lineTo((i + 1) * (canvas.width / MAX_POINTS), canvas.height - (points[i + 1] * 10));
                        ctx.stroke();
                    }
                }
            </script>
    </body>
</html>